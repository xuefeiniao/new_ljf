<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="keywords" content="{$web_keywords}" />
    <meta name="format-detection" content="telephone=no,email=no,address=no" />
    <eq name="Think.session.lang" value="1">
									<notempty name="coninfo['web_name']" value=" ">
								
										<title>{$coninfo['web_name']}</title>
									</notempty>
								</eq>
								<eq name="Think.session.lang" value="2">
									<notempty name="coninfo['web_name_e']" value=" ">
										<title>{$coninfo['web_name_e']}</title>
									</notempty>
								</eq>
								<eq name="Think.session.lang" value="3">
									<notempty name="coninfo['web_name_en']" value=" ">
										<title>{$coninfo['web_name_en']}</title>
									</notempty>
								</eq>
    <link data-n-head="true" rel="icon" type="image/x-icon" href="__PUBLIC__/favicon.ico"/>
    <link rel="stylesheet" href="__PUBLIC__/Home/css/newcss/base.css"/>
    <link rel="stylesheet" href="__PUBLIC__/Home/css/newcss/common.css"/>
    <link rel="stylesheet" type="text/css" href="__PUBLIC__/Home/css/newcss/change_login_password.css" media="all"/>
    <script data-n-head="true" src="__PUBLIC__/Home/js/newjs/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="__PUBLIC__/layer/layer.js"></script>

</head>
<body>

<!--<img src="https://mon.58coin.com/mon.gif" id="img-hidden" />-->
<div id="__nuxt">
    <div class="nuxt-progress" style="width: 0%; height: 2px; background-color: rgb(59, 128, 112); opacity: 0;"></div>
    <div id="__layout">
        <div>
            <!--头部内容-->
            <include file="Public:header1"/>
            <!--头部内容   end-->
            <div class="wrap">
                <div  class="container">
                    <div  class="user-bread flex-box flex-direction-row flex-justify-start flex-align-item-start flex-wrap-nowrap">
                        <div class="item flex-box flex-direction-row flex-justify-start flex-align-item-center flex-wrap-nowrap">
                            <a href="/User/index" class="nuxt-link-active">
                                <div class="flex-box flex-direction-row flex-justify-start flex-align-item-center flex-wrap-nowrap">
                                    <span>账户安全</span>
                                    <i></i>
                                </div></a>
                        </div>
                        <div class="item flex-box flex-direction-row flex-justify-start flex-align-item-center flex-wrap-nowrap">
                            <p>修改绑定手机号</p>
                        </div>
                    </div>
                    <div  class="st-content" style="margin-top: 30px;">
                        <h2>修改绑定手机号</h2>
                        <div class="line"></div>
                        <div class="setDiv" style="padding-top: 0px; padding-bottom: 0px;">
                            <div class="st-prompt" style="margin-top:20px;">
                                <span></span>
                                <p>温馨提示：修改手机号码24小时内不可以提现，人工无法解除</p>
                            </div>
                            <!--第一步-->
                            <div class="st-form">
                                <div class="st-form-item">
                                    <p class="label" style="padding-right: 16px;">短信验证码</p>
                                    <input name="old_message" id="old_message" type="number" placeholder="请输入原手机短信验证码" class="st-input" style="width:200px;"/>
                                    <input type="hidden" id="mobles" value="{$user['moble']}">
                                    <div class="send-SMS " onclick="sendMessage();" id="smsbtn">
                                        <a class="get-code button">
                                            <div>发送短信验证码</div>
                                        </a><!---->
                                    </div>
                                    <p class="tips" style="display: none;"></p>
                                    <p class="message" style="display: none;">请点击获取短信验证码！</p>
                                </div>
                                <div class="st-form-item">
                                    <p class="label" style="padding-right: 16px;">新手机号</p>
                                    <div class="entrust-filter-item flex-box flex-direction-row flex-justify-start flex-align-item-center flex-wrap-nowrap">
                                        <div class="select flex-box flex-direction-row flex-justify-start flex-align-item-start flex-wrap-nowrap" style="height: 100%;">
                                            <p class="" style="padding-left: 2px; width: 60px; line-height: 40px;">+86</p>
                                            <div class="arrow" style="background-position: center 14px;"></div>
                                            <input autocomplete="off" readonly="readonly" style="width: 60px;" />
                                            <ul style="left: 84%; top: 100%; display: none;">
                                                <li class="select-option"><p>中国大陆 +86</p></li>
                                                <li class="select-option"><p>中国澳门 +853</p></li>
                                                <li class="select-option"><p>中国香港 +852</p></li>
                                                <li class="select-option"><p>英国 +44</p></li>
                                                <li class="select-option"><p>俄罗斯 +7</p></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <input type="text" placeholder="请输入新手机号" name="new_mobile" id="new_mobile" class="st-input" style="padding: 0px 10px 0px 70px;"  />
                                    <p class="tips" style="display: none;"></p>
                                    <p class="message" style="display: none;">请输入手机号！</p>
                                </div>
                                <div class="st-form-item">
                                    <p class="label" style="padding-right: 16px;">短信验证码</p>
                                    <input name="new_message" id="new_message" type="number" maxlength="6" placeholder="请输入新手机短信验证码" class="st-input" style="width: 200px;" />
                                    <div class="send-SMS code" onclick="sendMessage1();" id="smsbtn1">
                                        <a class="get-code button">
                                            <div>
                                                发送短信验证码
                                            </div>
                                        </a>
                                        <!---->
                                    </div>
                                    <p class="tips" style="display: none;"></p>
                                    <p class="message" style="display: none;">请输入正确的短信验证码！</p>
                                </div>
                                <input type="submit" class="" value="更换绑定" id="sendEmail" onclick="tijiao()"/>
                                <div style="padding-top:0;padding-bottom:0;display: none;" class="successfulDiv">
                                    <div class="success">
                                        <div class="icon-success"></div>
                                        <p>更换成功</p>
                                        <div class="btn">
                                            <a href="index.html" class="button nuxt-link-active">去首页</a>
                                            <a class="button nuxt-link-active back-before">返回</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <!--图像验证码-->
                <div class="popupImg" style="display: none;">
                    <div class="flex-box flex-direction-row flex-justify-center flex-align-item-center flex-wrap-nowrap captcha">
                        <div class="bg"></div>
                        <div class="box">
                            <div class="header flex-box flex-direction-row flex-justify-between flex-align-item-center flex-wrap-nowrap">
                                <h3 >图形验证码</h3><a></a>
                            </div>
                            <div class="st-form">
                                <div class="st-form-item" style="min-height: 70px;" >
                                    <p class="label" style="padding-right: 16px;"></p>
                                    <input type="text" maxlength="6" placeholder="" class="st-input" >
                                    <a class="img">
                                        <img id="verify_up"  src="__URL__/code" class="codeImg reloadverify zhu-register">
                                    </a>
                                    <a class="change-pic" onclick="document.getElementById('verify_up').src=document.getElementById('verify_up').src+'?t='+Math.random()">换一张</a>
                                    <p  class="tips" style="display: none;"></p>
                                    <p class="message" style="display: none;">请输入正确的图形验证码！</p>
                                </div>
                                <input type="submit" value="提交" style="margin-bottom:30px;" id="submitBtn">
                            </div>
                        </div>
                    </div>
                </div>
                <!--底部内容-->
                <include file="Public:footer"/>
                <!--底部内容   end-->
            </div>
        </div>
    </div>
</div>


<script src="__PUBLIC__/Home/js/newjs/bindMoble.js"></script>

<script type="text/javascript">
     var InterValObj; //timer变量，控制时间
    var count = 60; //间隔函数，1秒执行
    var curCount;//当前剩余秒数
            
    function sendMessage() {
        if($("#smsbtn").find("div").attr("disabled")=="disabled"){
            return false;
        }else{
            var mobile = $('#mobles').val();
            //validatemobile(mobile);//调用上边的方法验证手机号码的正确性
            $.ajax({
                type: "POST", //用POST方式传输     　　
                dataType: "json", //数据格式:JSON
                data: {mobile:mobile},
                url: "{:U('Login/real')}", //目标地址.
                success:function(data){
                    if(data.status == 1){
                        layer.msg(data.info, {icon: 1});
                    }else{
                        layer.msg(data.info, {icon: 2});
                    }
                }

            });

            curCount = count;
            //设置button效果，开始计时
            $("#smsbtn").find("div").attr("disabled", "true");
            $("#smsbtn").find("div").html( + curCount + "s");
            InterValObj = window.setInterval(SetRemainTime, 1000); //启动计时器，1秒执行一次
            //向后台发送处理数据
        }

    }
    //timer处理函数
    function SetRemainTime() {
        if (curCount == 0) {
            window.clearInterval(InterValObj);//停止计时器
            $("#smsbtn").find("div").removeAttr("disabled");//启用按钮
            $("#smsbtn").find("div").html("发送短信验证码");

        }
        else {
            curCount--;
            $("#smsbtn").find("div").html( + curCount + "s");
        }
    }
</script>
<script type="text/javascript">
    var InterValObj; //timer变量，控制时间
    var count = 60; //间隔函数，1秒执行
    var curCount;//当前剩余秒数
            
    function sendMessage1() {
        if($("#smsbtn1").find("div").attr("disabled")=="disabled"){
            return false;
        }else{
            var mobile = $('#new_mobile').val();
            //validatemobile(mobile);//调用上边的方法验证手机号码的正确性
            if(mobile==''||mobile==null){
                $('#new_mobile').addClass("error").siblings("p.message").show();
                return false;
            }
            $.ajax({
                type: "POST", //用POST方式传输     　　
                dataType: "json", //数据格式:JSON
                data: {mobile:mobile},
                url: "{:U('Login/dx_real')}", //目标地址.
                success:function(data){
                    if(data.status == 1){
                        layer.msg(data.info, {icon: 1});
                    }else{
                        layer.msg(data.info, {icon: 2});
                    }
                }

            });

            curCount = count;
            //设置button效果，开始计时
            $("#smsbtn1").find("div").attr("disabled", "true");
            $("#smsbtn1").find("div").html( + curCount + "s");
            InterValObj = window.setInterval(SetRemainTime1, 1000); //启动计时器，1秒执行一次
            //向后台发送处理数据
        }

    }
    //timer处理函数
    function SetRemainTime1(){
        if (curCount == 0) {
            window.clearInterval(InterValObj);//停止计时器
            $("#smsbtn1").find("div").removeAttr("disabled");//启用按钮
            $("#smsbtn1").find("div").html("发送短信验证码");

        }
        else {
            curCount--;
            $("#smsbtn1").find("div").html( + curCount + "s");
        }
    }

    function tijiao(){
        var old_message = $('#old_message').val();
        var new_mobile = $('#new_mobile').val();
        var new_message = $('#new_message').val();
        if(old_message == '' ||old_message==null){
            layer.msg('请输入原手机短信验证码',{icon:2});return false;
        }
        if(new_mobile == '' ||new_mobile==null){
            layer.msg('请输入新手机号码',{icon:2});return false;
        }
        if(new_message == '' ||new_message==null){
            layer.msg('请输入新手机短信验证码',{icon:2});return false;
        }
        $.ajax({
            url:'/User/gh_moble',
            data:{old_message:old_message,new_mobile:new_mobile,new_message:new_message},
            type:'post',
            dataType:"json",
            success:function(data){
                if(data.status == 1){
                    layer.msg(data.info,{icon:1});
                }else{
                    layer.msg(data.info,{icon:2});
                }
            }
        });
    }
</script>
</body>
</html>